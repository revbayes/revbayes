################################################################################
#
# RevBayes Test-Script: Testing the .getTopologyFrequency() method of class
#                       TraceTree
#
# authors: Wenjie Zhu, David Cerny
#
################################################################################

seed(12345)

# Get taxa
sp_names <- ["A", "B", "C"]
for (i in 1:sp_names.size()) {
    species[i] <- taxon(taxonName=sp_names[i], speciesName=sp_names[i])
}

# Simulate birth-death trees for these taxa
write("psi\n", filename="output/three_taxon.trees", append=FALSE)
for (i in 1:10) {
    spTree ~ dnBirthDeath(lambda=0.3, mu=0.2, rootAge=10, rho=1,
                          samplingStrategy="uniform", condition="nTaxa",
                          taxa=species)
    write(spTree, "\n", filename="output/three_taxon.trees", append=TRUE)
}

# Read in the tree trace and calculate the frequency of each unique topology
tr_trace = readTreeTrace("output/three_taxon.trees", treetype="clock", burnin=0)
unique_topo = tr_trace.getUniqueTrees()
for (i in 1:unique_topo.size()) {
    tr_trace.getTopologyFrequency(unique_topo[i])
}

q()
